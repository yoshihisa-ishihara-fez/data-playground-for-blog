-- ============================================
-- 中間テーブルによるフィルタリング サンプルデータ
-- テーマ: レストランメニュー検索システム
-- ============================================

-- 商品テーブル
CREATE TABLE products (
    id   SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    price INTEGER NOT NULL
);

-- タグテーブル（category で味・ジャンル・アレルギーを分類）
CREATE TABLE tags (
    id       SERIAL PRIMARY KEY,
    name     TEXT NOT NULL,
    category TEXT NOT NULL  -- '味' / 'ジャンル' / 'アレルギー'
);

-- 中間テーブル（これがフィルタの要）
-- products と tags の多対多関係を表現する
CREATE TABLE product_tags (
    product_id INTEGER REFERENCES products(id),
    tag_id     INTEGER REFERENCES tags(id),
    PRIMARY KEY (product_id, tag_id)
);

-- ============================================
-- タグデータ
-- ============================================
INSERT INTO tags (id, name, category) VALUES
    -- 味
    (1, '辛い',     '味'),
    (2, '甘い',     '味'),
    (3, '酸っぱい', '味'),
    -- ジャンル
    (4, '和食', 'ジャンル'),
    (5, '洋食', 'ジャンル'),
    (6, '中華', 'ジャンル'),
    -- アレルギー
    (7, '乳製品', 'アレルギー'),
    (8, '小麦',   'アレルギー'),
    (9, '卵',     'アレルギー');

-- ============================================
-- 商品データ（10品）
-- ============================================
INSERT INTO products (id, name, price) VALUES
    (1,  '麻婆豆腐',         900),
    (2,  'カルボナーラ',     1200),
    (3,  '肉じゃが',         800),
    (4,  'グラタン',         1100),
    (5,  '酢豚',             950),
    (6,  'チーズケーキ',     600),
    (7,  'わらび餅',         500),
    (8,  'エビチリ',         1000),
    (9,  '天ぷらうどん',     850),
    (10, 'チョコレートケーキ', 700),
    (11, '辛味噌うどん',     900);

-- ============================================
-- 中間テーブル（product_tags）データ
-- 各商品に 2〜4 個のタグを付与
-- ============================================
INSERT INTO product_tags (product_id, tag_id) VALUES
    -- 麻婆豆腐: 辛い, 中華
    (1, 1), (1, 6),
    -- カルボナーラ: 洋食, 乳製品, 小麦, 卵
    (2, 5), (2, 7), (2, 8), (2, 9),
    -- 肉じゃが: 甘い, 和食
    (3, 2), (3, 4),
    -- グラタン: 洋食, 乳製品, 小麦
    (4, 5), (4, 7), (4, 8),
    -- 酢豚: 酸っぱい, 甘い, 中華
    (5, 3), (5, 2), (5, 6),
    -- チーズケーキ: 甘い, 洋食, 乳製品, 小麦, 卵
    (6, 2), (6, 5), (6, 7), (6, 8), (6, 9),
    -- わらび餅: 甘い, 和食
    (7, 2), (7, 4),
    -- エビチリ: 辛い, 中華
    (8, 1), (8, 6),
    -- 天ぷらうどん: 和食, 小麦, 卵
    (9, 4), (9, 8), (9, 9),
    -- チョコレートケーキ: 甘い, 洋食, 乳製品
    (10, 2), (10, 5), (10, 7),
    -- 辛味噌うどん: 辛い, 和食, 小麦
    (11, 1), (11, 4), (11, 8);
