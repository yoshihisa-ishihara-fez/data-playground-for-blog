-- ============================================
-- OR フィルタ: 「辛い」または「甘い」商品を取得
-- ============================================
--
-- やりたいこと:
--   「辛い」か「甘い」のどちらかのタグが付いている商品を取得する
--
-- 仕組み:
--   中間テーブル product_tags を JOIN して、
--   タグ名が '辛い' OR '甘い' のものを WHERE で絞り込む。
--   同じ商品が複数タグに該当する場合（例: 酢豚は甘い＋酸っぱい）があるので
--   DISTINCT で重複を除去する。
--
-- ポイント:
--   中間テーブルがなければ、商品テーブルに「味」カラムを持たせることになり、
--   1商品1味しか表現できない。中間テーブルがあるから複数タグで柔軟に検索できる。
-- ============================================

SELECT DISTINCT
    p.id,
    p.name,
    p.price
FROM products p
JOIN product_tags pt ON p.id = pt.product_id
JOIN tags t ON pt.tag_id = t.id
WHERE t.name IN ('辛い', '甘い')
ORDER BY p.id;
